import numba as nb

@nb.jit('f8(f8[::1],f8,f8,f8)',nopython=True)
def tricubic_interpolate(coeff,d0,d1,d2):
    value = 0.0
    l = 0
    for k in range(4):
        for j in range(4):
            for i in range(4):
                value += coeff[l] * d0**i * d1**j * d2**k
                l +=1
    return value

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_cr0(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return -(b1 - c1*h1 - lower1)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 + (b2 - c2*h2 - lower2)*(2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_cr1(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (b0 - c0*h0 - lower0)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 - (b2 - c2*h2 - lower2)*(a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_cr2(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return -(b0 - c0*h0 - lower0)*(2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1 + (b1 - c1*h1 - lower1)*(a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df0dx(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (((b0 - c0*h0 - lower0)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 - (b2 - c2*h2 - lower2)*(a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0)*(-2*h0*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 + 2*(b0 - c0*h0 - lower0)*(a[17] + 2*a[18]*c0 + 3*a[19]*c0**2 + a[21]*c1 + 2*a[22]*c0*c1 + 3*a[23]*c0**2*c1 + a[25]*c1**2 + 2*a[26]*c0*c1**2 + 3*a[27]*c0**2*c1**2 + a[29]*c1**3 + 2*a[30]*c0*c1**3 + 3*a[31]*c0**2*c1**3 + 2*a[33]*c2 + 4*a[34]*c0*c2 + 6*a[35]*c0**2*c2 + 2*a[37]*c1*c2 + 4*a[38]*c0*c1*c2 + 6*a[39]*c0**2*c1*c2 + 2*a[41]*c1**2*c2 + 4*a[42]*c0*c1**2*c2 + 6*a[43]*c0**2*c1**2*c2 + 2*a[45]*c1**3*c2 + 4*a[46]*c0*c1**3*c2 + 6*a[47]*c0**2*c1**3*c2 + 3*a[49]*c2**2 + 6*a[50]*c0*c2**2 + 9*a[51]*c0**2*c2**2 + 3*a[53]*c1*c2**2 + 6*a[54]*c0*c1*c2**2 + 9*a[55]*c0**2*c1*c2**2 + 3*a[57]*c1**2*c2**2 + 6*a[58]*c0*c1**2*c2**2 + 9*a[59]*c0**2*c1**2*c2**2 + 3*a[61]*c1**3*c2**2 + 6*a[62]*c0*c1**3*c2**2 + 9*a[63]*c0**2*c1**3*c2**2)/h2 - 2*(b2 - c2*h2 - lower2)*(2*a[10]*c1**2 + 6*a[11]*c0*c1**2 + 2*a[14]*c1**3 + 6*a[15]*c0*c1**3 + 2*a[18]*c2 + 6*a[19]*c0*c2 + 2*a[2] + 2*a[22]*c1*c2 + 6*a[23]*c0*c1*c2 + 2*a[26]*c1**2*c2 + 6*a[27]*c0*c1**2*c2 + 6*a[3]*c0 + 2*a[30]*c1**3*c2 + 6*a[31]*c0*c1**3*c2 + 2*a[34]*c2**2 + 6*a[35]*c0*c2**2 + 2*a[38]*c1*c2**2 + 6*a[39]*c0*c1*c2**2 + 2*a[42]*c1**2*c2**2 + 6*a[43]*c0*c1**2*c2**2 + 2*a[46]*c1**3*c2**2 + 6*a[47]*c0*c1**3*c2**2 + 2*a[50]*c2**3 + 6*a[51]*c0*c2**3 + 2*a[54]*c1*c2**3 + 6*a[55]*c0*c1*c2**3 + 2*a[58]*c1**2*c2**3 + 6*a[59]*c0*c1**2*c2**3 + 2*a[6]*c1 + 2*a[62]*c1**3*c2**3 + 6*a[63]*c0*c1**3*c2**3 + 6*a[7]*c0*c1)/h0) + (-2*(b1 - c1*h1 - lower1)*(a[17] + 2*a[18]*c0 + 3*a[19]*c0**2 + a[21]*c1 + 2*a[22]*c0*c1 + 3*a[23]*c0**2*c1 + a[25]*c1**2 + 2*a[26]*c0*c1**2 + 3*a[27]*c0**2*c1**2 + a[29]*c1**3 + 2*a[30]*c0*c1**3 + 3*a[31]*c0**2*c1**3 + 2*a[33]*c2 + 4*a[34]*c0*c2 + 6*a[35]*c0**2*c2 + 2*a[37]*c1*c2 + 4*a[38]*c0*c1*c2 + 6*a[39]*c0**2*c1*c2 + 2*a[41]*c1**2*c2 + 4*a[42]*c0*c1**2*c2 + 6*a[43]*c0**2*c1**2*c2 + 2*a[45]*c1**3*c2 + 4*a[46]*c0*c1**3*c2 + 6*a[47]*c0**2*c1**3*c2 + 3*a[49]*c2**2 + 6*a[50]*c0*c2**2 + 9*a[51]*c0**2*c2**2 + 3*a[53]*c1*c2**2 + 6*a[54]*c0*c1*c2**2 + 9*a[55]*c0**2*c1*c2**2 + 3*a[57]*c1**2*c2**2 + 6*a[58]*c0*c1**2*c2**2 + 9*a[59]*c0**2*c1**2*c2**2 + 3*a[61]*c1**3*c2**2 + 6*a[62]*c0*c1**3*c2**2 + 9*a[63]*c0**2*c1**3*c2**2)/h2 + 2*(b2 - c2*h2 - lower2)*(4*a[10]*c0*c1 + 6*a[11]*c0**2*c1 + 3*a[13]*c1**2 + 6*a[14]*c0*c1**2 + 9*a[15]*c0**2*c1**2 + a[21]*c2 + 2*a[22]*c0*c2 + 3*a[23]*c0**2*c2 + 2*a[25]*c1*c2 + 4*a[26]*c0*c1*c2 + 6*a[27]*c0**2*c1*c2 + 3*a[29]*c1**2*c2 + 6*a[30]*c0*c1**2*c2 + 9*a[31]*c0**2*c1**2*c2 + a[37]*c2**2 + 2*a[38]*c0*c2**2 + 3*a[39]*c0**2*c2**2 + 2*a[41]*c1*c2**2 + 4*a[42]*c0*c1*c2**2 + 6*a[43]*c0**2*c1*c2**2 + 3*a[45]*c1**2*c2**2 + 6*a[46]*c0*c1**2*c2**2 + 9*a[47]*c0**2*c1**2*c2**2 + a[5] + a[53]*c2**3 + 2*a[54]*c0*c2**3 + 3*a[55]*c0**2*c2**3 + 2*a[57]*c1*c2**3 + 4*a[58]*c0*c1*c2**3 + 6*a[59]*c0**2*c1*c2**3 + 2*a[6]*c0 + 3*a[61]*c1**2*c2**3 + 6*a[62]*c0*c1**2*c2**3 + 9*a[63]*c0**2*c1**2*c2**3 + 3*a[7]*c0**2 + 2*a[9]*c1)/h1)*(-(b1 - c1*h1 - lower1)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 + (b2 - c2*h2 - lower2)*(2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1))/h0

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df0dy(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return ((2*(b0 - c0*h0 - lower0)*(a[20] + a[21]*c0 + a[22]*c0**2 + a[23]*c0**3 + 2*a[24]*c1 + 2*a[25]*c0*c1 + 2*a[26]*c0**2*c1 + 2*a[27]*c0**3*c1 + 3*a[28]*c1**2 + 3*a[29]*c0*c1**2 + 3*a[30]*c0**2*c1**2 + 3*a[31]*c0**3*c1**2 + 2*a[36]*c2 + 2*a[37]*c0*c2 + 2*a[38]*c0**2*c2 + 2*a[39]*c0**3*c2 + 4*a[40]*c1*c2 + 4*a[41]*c0*c1*c2 + 4*a[42]*c0**2*c1*c2 + 4*a[43]*c0**3*c1*c2 + 6*a[44]*c1**2*c2 + 6*a[45]*c0*c1**2*c2 + 6*a[46]*c0**2*c1**2*c2 + 6*a[47]*c0**3*c1**2*c2 + 3*a[52]*c2**2 + 3*a[53]*c0*c2**2 + 3*a[54]*c0**2*c2**2 + 3*a[55]*c0**3*c2**2 + 6*a[56]*c1*c2**2 + 6*a[57]*c0*c1*c2**2 + 6*a[58]*c0**2*c1*c2**2 + 6*a[59]*c0**3*c1*c2**2 + 9*a[60]*c1**2*c2**2 + 9*a[61]*c0*c1**2*c2**2 + 9*a[62]*c0**2*c1**2*c2**2 + 9*a[63]*c0**3*c1**2*c2**2)/h2 - 2*(b2 - c2*h2 - lower2)*(4*a[10]*c0*c1 + 6*a[11]*c0**2*c1 + 3*a[13]*c1**2 + 6*a[14]*c0*c1**2 + 9*a[15]*c0**2*c1**2 + a[21]*c2 + 2*a[22]*c0*c2 + 3*a[23]*c0**2*c2 + 2*a[25]*c1*c2 + 4*a[26]*c0*c1*c2 + 6*a[27]*c0**2*c1*c2 + 3*a[29]*c1**2*c2 + 6*a[30]*c0*c1**2*c2 + 9*a[31]*c0**2*c1**2*c2 + a[37]*c2**2 + 2*a[38]*c0*c2**2 + 3*a[39]*c0**2*c2**2 + 2*a[41]*c1*c2**2 + 4*a[42]*c0*c1*c2**2 + 6*a[43]*c0**2*c1*c2**2 + 3*a[45]*c1**2*c2**2 + 6*a[46]*c0*c1**2*c2**2 + 9*a[47]*c0**2*c1**2*c2**2 + a[5] + a[53]*c2**3 + 2*a[54]*c0*c2**3 + 3*a[55]*c0**2*c2**3 + 2*a[57]*c1*c2**3 + 4*a[58]*c0*c1*c2**3 + 6*a[59]*c0**2*c1*c2**3 + 2*a[6]*c0 + 3*a[61]*c1**2*c2**3 + 6*a[62]*c0*c1**2*c2**3 + 9*a[63]*c0**2*c1**2*c2**3 + 3*a[7]*c0**2 + 2*a[9]*c1)/h0)*((b0 - c0*h0 - lower0)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 - (b2 - c2*h2 - lower2)*(a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0) + (-(b1 - c1*h1 - lower1)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 + (b2 - c2*h2 - lower2)*(2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1)*(2*h1*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 - 2*(b1 - c1*h1 - lower1)*(a[20] + a[21]*c0 + a[22]*c0**2 + a[23]*c0**3 + 2*a[24]*c1 + 2*a[25]*c0*c1 + 2*a[26]*c0**2*c1 + 2*a[27]*c0**3*c1 + 3*a[28]*c1**2 + 3*a[29]*c0*c1**2 + 3*a[30]*c0**2*c1**2 + 3*a[31]*c0**3*c1**2 + 2*a[36]*c2 + 2*a[37]*c0*c2 + 2*a[38]*c0**2*c2 + 2*a[39]*c0**3*c2 + 4*a[40]*c1*c2 + 4*a[41]*c0*c1*c2 + 4*a[42]*c0**2*c1*c2 + 4*a[43]*c0**3*c1*c2 + 6*a[44]*c1**2*c2 + 6*a[45]*c0*c1**2*c2 + 6*a[46]*c0**2*c1**2*c2 + 6*a[47]*c0**3*c1**2*c2 + 3*a[52]*c2**2 + 3*a[53]*c0*c2**2 + 3*a[54]*c0**2*c2**2 + 3*a[55]*c0**3*c2**2 + 6*a[56]*c1*c2**2 + 6*a[57]*c0*c1*c2**2 + 6*a[58]*c0**2*c1*c2**2 + 6*a[59]*c0**3*c1*c2**2 + 9*a[60]*c1**2*c2**2 + 9*a[61]*c0*c1**2*c2**2 + 9*a[62]*c0**2*c1**2*c2**2 + 9*a[63]*c0**3*c1**2*c2**2)/h2 + 2*(b2 - c2*h2 - lower2)*(2*a[10]*c0**2 + 2*a[11]*c0**3 + 6*a[12]*c1 + 6*a[13]*c0*c1 + 6*a[14]*c0**2*c1 + 6*a[15]*c0**3*c1 + 2*a[24]*c2 + 2*a[25]*c0*c2 + 2*a[26]*c0**2*c2 + 2*a[27]*c0**3*c2 + 6*a[28]*c1*c2 + 6*a[29]*c0*c1*c2 + 6*a[30]*c0**2*c1*c2 + 6*a[31]*c0**3*c1*c2 + 2*a[40]*c2**2 + 2*a[41]*c0*c2**2 + 2*a[42]*c0**2*c2**2 + 2*a[43]*c0**3*c2**2 + 6*a[44]*c1*c2**2 + 6*a[45]*c0*c1*c2**2 + 6*a[46]*c0**2*c1*c2**2 + 6*a[47]*c0**3*c1*c2**2 + 2*a[56]*c2**3 + 2*a[57]*c0*c2**3 + 2*a[58]*c0**2*c2**3 + 2*a[59]*c0**3*c2**3 + 6*a[60]*c1*c2**3 + 6*a[61]*c0*c1*c2**3 + 6*a[62]*c0**2*c1*c2**3 + 6*a[63]*c0**3*c1*c2**3 + 2*a[8] + 2*a[9]*c0)/h1))/h1

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df0dz(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (((b0 - c0*h0 - lower0)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 - (b2 - c2*h2 - lower2)*(a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0)*(2*(b0 - c0*h0 - lower0)*(2*a[32] + 2*a[33]*c0 + 2*a[34]*c0**2 + 2*a[35]*c0**3 + 2*a[36]*c1 + 2*a[37]*c0*c1 + 2*a[38]*c0**2*c1 + 2*a[39]*c0**3*c1 + 2*a[40]*c1**2 + 2*a[41]*c0*c1**2 + 2*a[42]*c0**2*c1**2 + 2*a[43]*c0**3*c1**2 + 2*a[44]*c1**3 + 2*a[45]*c0*c1**3 + 2*a[46]*c0**2*c1**3 + 2*a[47]*c0**3*c1**3 + 6*a[48]*c2 + 6*a[49]*c0*c2 + 6*a[50]*c0**2*c2 + 6*a[51]*c0**3*c2 + 6*a[52]*c1*c2 + 6*a[53]*c0*c1*c2 + 6*a[54]*c0**2*c1*c2 + 6*a[55]*c0**3*c1*c2 + 6*a[56]*c1**2*c2 + 6*a[57]*c0*c1**2*c2 + 6*a[58]*c0**2*c1**2*c2 + 6*a[59]*c0**3*c1**2*c2 + 6*a[60]*c1**3*c2 + 6*a[61]*c0*c1**3*c2 + 6*a[62]*c0**2*c1**3*c2 + 6*a[63]*c0**3*c1**3*c2)/h2 + 2*h2*(a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0 - 2*(b2 - c2*h2 - lower2)*(a[17] + 2*a[18]*c0 + 3*a[19]*c0**2 + a[21]*c1 + 2*a[22]*c0*c1 + 3*a[23]*c0**2*c1 + a[25]*c1**2 + 2*a[26]*c0*c1**2 + 3*a[27]*c0**2*c1**2 + a[29]*c1**3 + 2*a[30]*c0*c1**3 + 3*a[31]*c0**2*c1**3 + 2*a[33]*c2 + 4*a[34]*c0*c2 + 6*a[35]*c0**2*c2 + 2*a[37]*c1*c2 + 4*a[38]*c0*c1*c2 + 6*a[39]*c0**2*c1*c2 + 2*a[41]*c1**2*c2 + 4*a[42]*c0*c1**2*c2 + 6*a[43]*c0**2*c1**2*c2 + 2*a[45]*c1**3*c2 + 4*a[46]*c0*c1**3*c2 + 6*a[47]*c0**2*c1**3*c2 + 3*a[49]*c2**2 + 6*a[50]*c0*c2**2 + 9*a[51]*c0**2*c2**2 + 3*a[53]*c1*c2**2 + 6*a[54]*c0*c1*c2**2 + 9*a[55]*c0**2*c1*c2**2 + 3*a[57]*c1**2*c2**2 + 6*a[58]*c0*c1**2*c2**2 + 9*a[59]*c0**2*c1**2*c2**2 + 3*a[61]*c1**3*c2**2 + 6*a[62]*c0*c1**3*c2**2 + 9*a[63]*c0**2*c1**3*c2**2)/h0) + (-(b1 - c1*h1 - lower1)*(a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2 + (b2 - c2*h2 - lower2)*(2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1)*(-2*(b1 - c1*h1 - lower1)*(2*a[32] + 2*a[33]*c0 + 2*a[34]*c0**2 + 2*a[35]*c0**3 + 2*a[36]*c1 + 2*a[37]*c0*c1 + 2*a[38]*c0**2*c1 + 2*a[39]*c0**3*c1 + 2*a[40]*c1**2 + 2*a[41]*c0*c1**2 + 2*a[42]*c0**2*c1**2 + 2*a[43]*c0**3*c1**2 + 2*a[44]*c1**3 + 2*a[45]*c0*c1**3 + 2*a[46]*c0**2*c1**3 + 2*a[47]*c0**3*c1**3 + 6*a[48]*c2 + 6*a[49]*c0*c2 + 6*a[50]*c0**2*c2 + 6*a[51]*c0**3*c2 + 6*a[52]*c1*c2 + 6*a[53]*c0*c1*c2 + 6*a[54]*c0**2*c1*c2 + 6*a[55]*c0**3*c1*c2 + 6*a[56]*c1**2*c2 + 6*a[57]*c0*c1**2*c2 + 6*a[58]*c0**2*c1**2*c2 + 6*a[59]*c0**3*c1**2*c2 + 6*a[60]*c1**3*c2 + 6*a[61]*c0*c1**3*c2 + 6*a[62]*c0**2*c1**3*c2 + 6*a[63]*c0**3*c1**3*c2)/h2 - 2*h2*(2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1 + 2*(b2 - c2*h2 - lower2)*(a[20] + a[21]*c0 + a[22]*c0**2 + a[23]*c0**3 + 2*a[24]*c1 + 2*a[25]*c0*c1 + 2*a[26]*c0**2*c1 + 2*a[27]*c0**3*c1 + 3*a[28]*c1**2 + 3*a[29]*c0*c1**2 + 3*a[30]*c0**2*c1**2 + 3*a[31]*c0**3*c1**2 + 2*a[36]*c2 + 2*a[37]*c0*c2 + 2*a[38]*c0**2*c2 + 2*a[39]*c0**3*c2 + 4*a[40]*c1*c2 + 4*a[41]*c0*c1*c2 + 4*a[42]*c0**2*c1*c2 + 4*a[43]*c0**3*c1*c2 + 6*a[44]*c1**2*c2 + 6*a[45]*c0*c1**2*c2 + 6*a[46]*c0**2*c1**2*c2 + 6*a[47]*c0**3*c1**2*c2 + 3*a[52]*c2**2 + 3*a[53]*c0*c2**2 + 3*a[54]*c0**2*c2**2 + 3*a[55]*c0**3*c2**2 + 6*a[56]*c1*c2**2 + 6*a[57]*c0*c1*c2**2 + 6*a[58]*c0**2*c1*c2**2 + 6*a[59]*c0**3*c1*c2**2 + 9*a[60]*c1**2*c2**2 + 9*a[61]*c0*c1**2*c2**2 + 9*a[62]*c0**2*c1**2*c2**2 + 9*a[63]*c0**3*c1**2*c2**2)/h1))/h2

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df1dx(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (h0*(2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1 - (b0 - c0*h0 - lower0)*(4*a[10]*c0*c1 + 6*a[11]*c0**2*c1 + 3*a[13]*c1**2 + 6*a[14]*c0*c1**2 + 9*a[15]*c0**2*c1**2 + a[21]*c2 + 2*a[22]*c0*c2 + 3*a[23]*c0**2*c2 + 2*a[25]*c1*c2 + 4*a[26]*c0*c1*c2 + 6*a[27]*c0**2*c1*c2 + 3*a[29]*c1**2*c2 + 6*a[30]*c0*c1**2*c2 + 9*a[31]*c0**2*c1**2*c2 + a[37]*c2**2 + 2*a[38]*c0*c2**2 + 3*a[39]*c0**2*c2**2 + 2*a[41]*c1*c2**2 + 4*a[42]*c0*c1*c2**2 + 6*a[43]*c0**2*c1*c2**2 + 3*a[45]*c1**2*c2**2 + 6*a[46]*c0*c1**2*c2**2 + 9*a[47]*c0**2*c1**2*c2**2 + a[5] + a[53]*c2**3 + 2*a[54]*c0*c2**3 + 3*a[55]*c0**2*c2**3 + 2*a[57]*c1*c2**3 + 4*a[58]*c0*c1*c2**3 + 6*a[59]*c0**2*c1*c2**3 + 2*a[6]*c0 + 3*a[61]*c1**2*c2**3 + 6*a[62]*c0*c1**2*c2**3 + 9*a[63]*c0**2*c1**2*c2**3 + 3*a[7]*c0**2 + 2*a[9]*c1)/h1 + (b1 - c1*h1 - lower1)*(2*a[10]*c1**2 + 6*a[11]*c0*c1**2 + 2*a[14]*c1**3 + 6*a[15]*c0*c1**3 + 2*a[18]*c2 + 6*a[19]*c0*c2 + 2*a[2] + 2*a[22]*c1*c2 + 6*a[23]*c0*c1*c2 + 2*a[26]*c1**2*c2 + 6*a[27]*c0*c1**2*c2 + 6*a[3]*c0 + 2*a[30]*c1**3*c2 + 6*a[31]*c0*c1**3*c2 + 2*a[34]*c2**2 + 6*a[35]*c0*c2**2 + 2*a[38]*c1*c2**2 + 6*a[39]*c0*c1*c2**2 + 2*a[42]*c1**2*c2**2 + 6*a[43]*c0*c1**2*c2**2 + 2*a[46]*c1**3*c2**2 + 6*a[47]*c0*c1**3*c2**2 + 2*a[50]*c2**3 + 6*a[51]*c0*c2**3 + 2*a[54]*c1*c2**3 + 6*a[55]*c0*c1*c2**3 + 2*a[58]*c1**2*c2**3 + 6*a[59]*c0*c1**2*c2**3 + 2*a[6]*c1 + 2*a[62]*c1**3*c2**3 + 6*a[63]*c0*c1**3*c2**3 + 6*a[7]*c0*c1)/h0)/h0

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df1dy(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (-(b0 - c0*h0 - lower0)*(2*a[10]*c0**2 + 2*a[11]*c0**3 + 6*a[12]*c1 + 6*a[13]*c0*c1 + 6*a[14]*c0**2*c1 + 6*a[15]*c0**3*c1 + 2*a[24]*c2 + 2*a[25]*c0*c2 + 2*a[26]*c0**2*c2 + 2*a[27]*c0**3*c2 + 6*a[28]*c1*c2 + 6*a[29]*c0*c1*c2 + 6*a[30]*c0**2*c1*c2 + 6*a[31]*c0**3*c1*c2 + 2*a[40]*c2**2 + 2*a[41]*c0*c2**2 + 2*a[42]*c0**2*c2**2 + 2*a[43]*c0**3*c2**2 + 6*a[44]*c1*c2**2 + 6*a[45]*c0*c1*c2**2 + 6*a[46]*c0**2*c1*c2**2 + 6*a[47]*c0**3*c1*c2**2 + 2*a[56]*c2**3 + 2*a[57]*c0*c2**3 + 2*a[58]*c0**2*c2**3 + 2*a[59]*c0**3*c2**3 + 6*a[60]*c1*c2**3 + 6*a[61]*c0*c1*c2**3 + 6*a[62]*c0**2*c1*c2**3 + 6*a[63]*c0**3*c1*c2**3 + 2*a[8] + 2*a[9]*c0)/h1 - h1*(a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0 + (b1 - c1*h1 - lower1)*(4*a[10]*c0*c1 + 6*a[11]*c0**2*c1 + 3*a[13]*c1**2 + 6*a[14]*c0*c1**2 + 9*a[15]*c0**2*c1**2 + a[21]*c2 + 2*a[22]*c0*c2 + 3*a[23]*c0**2*c2 + 2*a[25]*c1*c2 + 4*a[26]*c0*c1*c2 + 6*a[27]*c0**2*c1*c2 + 3*a[29]*c1**2*c2 + 6*a[30]*c0*c1**2*c2 + 9*a[31]*c0**2*c1**2*c2 + a[37]*c2**2 + 2*a[38]*c0*c2**2 + 3*a[39]*c0**2*c2**2 + 2*a[41]*c1*c2**2 + 4*a[42]*c0*c1*c2**2 + 6*a[43]*c0**2*c1*c2**2 + 3*a[45]*c1**2*c2**2 + 6*a[46]*c0*c1**2*c2**2 + 9*a[47]*c0**2*c1**2*c2**2 + a[5] + a[53]*c2**3 + 2*a[54]*c0*c2**3 + 3*a[55]*c0**2*c2**3 + 2*a[57]*c1*c2**3 + 4*a[58]*c0*c1*c2**3 + 6*a[59]*c0**2*c1*c2**3 + 2*a[6]*c0 + 3*a[61]*c1**2*c2**3 + 6*a[62]*c0*c1**2*c2**3 + 9*a[63]*c0**2*c1**2*c2**3 + 3*a[7]*c0**2 + 2*a[9]*c1)/h0)/h1

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df1dz(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (-(b0 - c0*h0 - lower0)*(a[20] + a[21]*c0 + a[22]*c0**2 + a[23]*c0**3 + 2*a[24]*c1 + 2*a[25]*c0*c1 + 2*a[26]*c0**2*c1 + 2*a[27]*c0**3*c1 + 3*a[28]*c1**2 + 3*a[29]*c0*c1**2 + 3*a[30]*c0**2*c1**2 + 3*a[31]*c0**3*c1**2 + 2*a[36]*c2 + 2*a[37]*c0*c2 + 2*a[38]*c0**2*c2 + 2*a[39]*c0**3*c2 + 4*a[40]*c1*c2 + 4*a[41]*c0*c1*c2 + 4*a[42]*c0**2*c1*c2 + 4*a[43]*c0**3*c1*c2 + 6*a[44]*c1**2*c2 + 6*a[45]*c0*c1**2*c2 + 6*a[46]*c0**2*c1**2*c2 + 6*a[47]*c0**3*c1**2*c2 + 3*a[52]*c2**2 + 3*a[53]*c0*c2**2 + 3*a[54]*c0**2*c2**2 + 3*a[55]*c0**3*c2**2 + 6*a[56]*c1*c2**2 + 6*a[57]*c0*c1*c2**2 + 6*a[58]*c0**2*c1*c2**2 + 6*a[59]*c0**3*c1*c2**2 + 9*a[60]*c1**2*c2**2 + 9*a[61]*c0*c1**2*c2**2 + 9*a[62]*c0**2*c1**2*c2**2 + 9*a[63]*c0**3*c1**2*c2**2)/h1 + (b1 - c1*h1 - lower1)*(a[17] + 2*a[18]*c0 + 3*a[19]*c0**2 + a[21]*c1 + 2*a[22]*c0*c1 + 3*a[23]*c0**2*c1 + a[25]*c1**2 + 2*a[26]*c0*c1**2 + 3*a[27]*c0**2*c1**2 + a[29]*c1**3 + 2*a[30]*c0*c1**3 + 3*a[31]*c0**2*c1**3 + 2*a[33]*c2 + 4*a[34]*c0*c2 + 6*a[35]*c0**2*c2 + 2*a[37]*c1*c2 + 4*a[38]*c0*c1*c2 + 6*a[39]*c0**2*c1*c2 + 2*a[41]*c1**2*c2 + 4*a[42]*c0*c1**2*c2 + 6*a[43]*c0**2*c1**2*c2 + 2*a[45]*c1**3*c2 + 4*a[46]*c0*c1**3*c2 + 6*a[47]*c0**2*c1**3*c2 + 3*a[49]*c2**2 + 6*a[50]*c0*c2**2 + 9*a[51]*c0**2*c2**2 + 3*a[53]*c1*c2**2 + 6*a[54]*c0*c1*c2**2 + 9*a[55]*c0**2*c1*c2**2 + 3*a[57]*c1**2*c2**2 + 6*a[58]*c0*c1**2*c2**2 + 9*a[59]*c0**2*c1**2*c2**2 + 3*a[61]*c1**3*c2**2 + 6*a[62]*c0*c1**3*c2**2 + 9*a[63]*c0**2*c1**3*c2**2)/h0)/h2

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df2dx(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (a[1] + 2*a[10]*c0*c1**2 + 3*a[11]*c0**2*c1**2 + a[13]*c1**3 + 2*a[14]*c0*c1**3 + 3*a[15]*c0**2*c1**3 + a[17]*c2 + 2*a[18]*c0*c2 + 3*a[19]*c0**2*c2 + 2*a[2]*c0 + a[21]*c1*c2 + 2*a[22]*c0*c1*c2 + 3*a[23]*c0**2*c1*c2 + a[25]*c1**2*c2 + 2*a[26]*c0*c1**2*c2 + 3*a[27]*c0**2*c1**2*c2 + a[29]*c1**3*c2 + 3*a[3]*c0**2 + 2*a[30]*c0*c1**3*c2 + 3*a[31]*c0**2*c1**3*c2 + a[33]*c2**2 + 2*a[34]*c0*c2**2 + 3*a[35]*c0**2*c2**2 + a[37]*c1*c2**2 + 2*a[38]*c0*c1*c2**2 + 3*a[39]*c0**2*c1*c2**2 + a[41]*c1**2*c2**2 + 2*a[42]*c0*c1**2*c2**2 + 3*a[43]*c0**2*c1**2*c2**2 + a[45]*c1**3*c2**2 + 2*a[46]*c0*c1**3*c2**2 + 3*a[47]*c0**2*c1**3*c2**2 + a[49]*c2**3 + a[5]*c1 + 2*a[50]*c0*c2**3 + 3*a[51]*c0**2*c2**3 + a[53]*c1*c2**3 + 2*a[54]*c0*c1*c2**3 + 3*a[55]*c0**2*c1*c2**3 + a[57]*c1**2*c2**3 + 2*a[58]*c0*c1**2*c2**3 + 3*a[59]*c0**2*c1**2*c2**3 + 2*a[6]*c0*c1 + a[61]*c1**3*c2**3 + 2*a[62]*c0*c1**3*c2**3 + 3*a[63]*c0**2*c1**3*c2**3 + 3*a[7]*c0**2*c1 + a[9]*c1**2)/h0

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df2dy(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (2*a[10]*c0**2*c1 + 2*a[11]*c0**3*c1 + 3*a[12]*c1**2 + 3*a[13]*c0*c1**2 + 3*a[14]*c0**2*c1**2 + 3*a[15]*c0**3*c1**2 + a[20]*c2 + a[21]*c0*c2 + a[22]*c0**2*c2 + a[23]*c0**3*c2 + 2*a[24]*c1*c2 + 2*a[25]*c0*c1*c2 + 2*a[26]*c0**2*c1*c2 + 2*a[27]*c0**3*c1*c2 + 3*a[28]*c1**2*c2 + 3*a[29]*c0*c1**2*c2 + 3*a[30]*c0**2*c1**2*c2 + 3*a[31]*c0**3*c1**2*c2 + a[36]*c2**2 + a[37]*c0*c2**2 + a[38]*c0**2*c2**2 + a[39]*c0**3*c2**2 + a[4] + 2*a[40]*c1*c2**2 + 2*a[41]*c0*c1*c2**2 + 2*a[42]*c0**2*c1*c2**2 + 2*a[43]*c0**3*c1*c2**2 + 3*a[44]*c1**2*c2**2 + 3*a[45]*c0*c1**2*c2**2 + 3*a[46]*c0**2*c1**2*c2**2 + 3*a[47]*c0**3*c1**2*c2**2 + a[5]*c0 + a[52]*c2**3 + a[53]*c0*c2**3 + a[54]*c0**2*c2**3 + a[55]*c0**3*c2**3 + 2*a[56]*c1*c2**3 + 2*a[57]*c0*c1*c2**3 + 2*a[58]*c0**2*c1*c2**3 + 2*a[59]*c0**3*c1*c2**3 + a[6]*c0**2 + 3*a[60]*c1**2*c2**3 + 3*a[61]*c0*c1**2*c2**3 + 3*a[62]*c0**2*c1**2*c2**3 + 3*a[63]*c0**3*c1**2*c2**3 + a[7]*c0**3 + 2*a[8]*c1 + 2*a[9]*c0*c1)/h1

@nb.jit('f8(f8[::1],f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8,f8)',nopython=True)
def tricubic_df2dz(a,b0,b1,b2,h0,h1,h2,c0,c1,c2,lower0,lower1,lower2):
    return (a[16] + a[17]*c0 + a[18]*c0**2 + a[19]*c0**3 + a[20]*c1 + a[21]*c0*c1 + a[22]*c0**2*c1 + a[23]*c0**3*c1 + a[24]*c1**2 + a[25]*c0*c1**2 + a[26]*c0**2*c1**2 + a[27]*c0**3*c1**2 + a[28]*c1**3 + a[29]*c0*c1**3 + a[30]*c0**2*c1**3 + a[31]*c0**3*c1**3 + 2*a[32]*c2 + 2*a[33]*c0*c2 + 2*a[34]*c0**2*c2 + 2*a[35]*c0**3*c2 + 2*a[36]*c1*c2 + 2*a[37]*c0*c1*c2 + 2*a[38]*c0**2*c1*c2 + 2*a[39]*c0**3*c1*c2 + 2*a[40]*c1**2*c2 + 2*a[41]*c0*c1**2*c2 + 2*a[42]*c0**2*c1**2*c2 + 2*a[43]*c0**3*c1**2*c2 + 2*a[44]*c1**3*c2 + 2*a[45]*c0*c1**3*c2 + 2*a[46]*c0**2*c1**3*c2 + 2*a[47]*c0**3*c1**3*c2 + 3*a[48]*c2**2 + 3*a[49]*c0*c2**2 + 3*a[50]*c0**2*c2**2 + 3*a[51]*c0**3*c2**2 + 3*a[52]*c1*c2**2 + 3*a[53]*c0*c1*c2**2 + 3*a[54]*c0**2*c1*c2**2 + 3*a[55]*c0**3*c1*c2**2 + 3*a[56]*c1**2*c2**2 + 3*a[57]*c0*c1**2*c2**2 + 3*a[58]*c0**2*c1**2*c2**2 + 3*a[59]*c0**3*c1**2*c2**2 + 3*a[60]*c1**3*c2**2 + 3*a[61]*c0*c1**3*c2**2 + 3*a[62]*c0**2*c1**3*c2**2 + 3*a[63]*c0**3*c1**3*c2**2)/h2
